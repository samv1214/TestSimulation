import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { motion } from 'framer-motion';

const scenarios = {
  start: {
    text: "You wake up on a cold park bench. You're homeless. The sun is rising, and your stomach growls. What do you do?",
    options: [
      { text: "Look for food in trash bins", next: "trash_bins" },
      { text: "Ask strangers for money", next: "ask_money" },
      { text: "Go to a shelter", next: "shelter" }
    ],
    background: "bg-[url('/park.jpg')] bg-cover bg-center"
  },
  trash_bins: {
    text: "You find half a sandwich. It's stale but edible. A police officer approaches. What do you do?",
    options: [
      { text: "Run away", next: "runaway" },
      { text: "Explain yourself", next: "explain" },
      { text: "Ignore and keep eating", next: "ignore" }
    ],
    background: "bg-[url('/alley.jpg')] bg-cover bg-center"
  },
  ask_money: {
    text: "People ignore you, but one person gives you $5. What do you do with it?",
    options: [
      { text: "Buy food", next: "buy_food" },
      { text: "Buy alcohol", next: "buy_alcohol" },
      { text: "Save it", next: "save_money" }
    ],
    background: "bg-[url('/street.jpg')] bg-cover bg-center"
  },
  shelter: {
    text: "The shelter is full. They give you a blanket and a meal voucher for tomorrow. What do you do next?",
    options: [
      { text: "Sleep outside nearby", next: "sleep_outside" },
      { text: "Try to sneak in", next: "sneak_in" },
      { text: "Look for another shelter", next: "look_shelter" }
    ],
    background: "bg-[url('/shelter.jpg')] bg-cover bg-center"
  },
  runaway: { text: "You got away, but you're still hungry. You didn't survive the night.", options: [], background: "bg-[url('/night.jpg')] bg-cover bg-center", end: true },
  explain: { text: "The officer understands and directs you to a soup kitchen. You survived another day.", options: [], background: "bg-[url('/kitchen.jpg')] bg-cover bg-center", end: true },
  ignore: { text: "The officer arrests you for loitering. You didn't survive.", options: [], background: "bg-[url('/jail.jpg')] bg-cover bg-center", end: true },
  buy_food: { text: "You eat and survive another day.", options: [], background: "bg-[url('/food.jpg')] bg-cover bg-center", end: true },
  buy_alcohol: { text: "You got drunk and passed out. You didn't survive.", options: [], background: "bg-[url('/drunk.jpg')] bg-cover bg-center", end: true },
  save_money: { text: "You saved it, but went hungry. You didn't survive.", options: [], background: "bg-[url('/night.jpg')] bg-cover bg-center", end: true },
  sleep_outside: { text: "You froze to death. You didn't survive.", options: [], background: "bg-[url('/night.jpg')] bg-cover bg-center", end: true },
  sneak_in: { text: "You got caught and arrested. You didn't survive.", options: [], background: "bg-[url('/jail.jpg')] bg-cover bg-center", end: true },
  look_shelter: { text: "You found another shelter and survived the night.", options: [], background: "bg-[url('/shelter2.jpg')] bg-cover bg-center", end: true }
};

export default function HomelessSimulation() {
  const [scene, setScene] = useState('start');

  const handleOption = (next) => {
    setScene(next);
  };

  return (
    <div className={`min-h-screen ${scenarios[scene].background} flex flex-col items-center justify-center text-white p-10 text-center`}>
      <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ duration: 1 }}>
        <h1 className="text-3xl mb-6">{scenarios[scene].text}</h1>
        {scenarios[scene].options.length > 0 ? (
          scenarios[scene].options.map((option, index) => (
            <Button key={index} className="m-2" onClick={() => handleOption(option.next)}>
              {option.text}
            </Button>
          ))
        ) : (
          <div>
            <p className="text-lg">Fact: Over 580,000 people experience homelessness in the U.S. on any given night.</p>
            <Button className="mt-4" onClick={() => setScene('start')}>Restart</Button>
          </div>
        )}
      </motion.div>
    </div>
  );
}
